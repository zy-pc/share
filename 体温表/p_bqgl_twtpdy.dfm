object frm_bqgl_twtpdy: Tfrm_bqgl_twtpdy
  Left = 0
  Top = 0
  Caption = #20307#28201#34920#22270#29255#25171#21360
  ClientHeight = 575
  ClientWidth = 756
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  Position = poScreenCenter
  WindowState = wsMaximized
  PixelsPerInch = 96
  TextHeight = 13
  object pnl1: TPanel
    Left = 0
    Top = 129
    Width = 756
    Height = 446
    Align = alClient
    Caption = 'pnl1'
    TabOrder = 0
    object img1: TImage
      Left = 1
      Top = 1
      Width = 754
      Height = 444
      Align = alClient
      ExplicitLeft = 2
    end
  end
  object pnl2: TPanel
    Left = 0
    Top = 0
    Width = 756
    Height = 129
    Align = alTop
    TabOrder = 1
    object lbl1: TLabel
      Left = 104
      Top = 6
      Width = 12
      Height = 13
      Caption = #23485
    end
    object lbl2: TLabel
      Left = 199
      Top = 6
      Width = 12
      Height = 13
      Caption = #39640
    end
    object lbl3: TLabel
      Left = 440
      Top = 6
      Width = 24
      Height = 13
      Caption = #28201#24230
    end
    object lbl4: TLabel
      Left = 39
      Top = 62
      Width = 60
      Height = 13
      Caption = #38477#28201#21518#28201#24230
    end
    object lbl5: TLabel
      Left = 64
      Top = 36
      Width = 24
      Height = 13
      Caption = #24207#21495
    end
    object lbl6: TLabel
      Left = 208
      Top = 40
      Width = 24
      Height = 13
      Caption = #22825#25968
    end
    object lbl7: TLabel
      Left = 49
      Top = 89
      Width = 24
      Height = 13
      Caption = #21407#22240
    end
    object lbl8: TLabel
      Left = 288
      Top = 68
      Width = 36
      Height = 13
      Caption = #20303#38498#21495
    end
    object lbl9: TLabel
      Left = 288
      Top = 95
      Width = 24
      Height = 13
      Caption = #39029#30721
    end
    object lbl10: TLabel
      Left = 570
      Top = 6
      Width = 48
      Height = 13
      Caption = #23383#20307#22823#23567
    end
    object btn1: TButton
      Left = 23
      Top = 5
      Width = 75
      Height = 25
      Caption = #30011#22270
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clBtnShadow
      Font.Height = -11
      Font.Name = 'Tahoma'
      Font.Style = [fsBold]
      ParentFont = False
      TabOrder = 0
      OnClick = btn1Click
    end
    object se2: TSpinEdit
      Left = 217
      Top = 3
      Width = 64
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 1
      Value = 1100
    end
    object btn2: TButton
      Left = 336
      Top = 3
      Width = 75
      Height = 25
      Caption = #25171#21360
      TabOrder = 2
      OnClick = btn2Click
    end
    object edt_1: TEdit
      Left = 470
      Top = 3
      Width = 73
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 3
      Text = '38'
    end
    object edt_2: TEdit
      Left = 105
      Top = 59
      Width = 58
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 4
    end
    object cbb1: TComboBox
      Left = 169
      Top = 59
      Width = 98
      Height = 21
      Style = csDropDownList
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      ItemHeight = 13
      ItemIndex = 0
      TabOrder = 5
      Text = #33099#19979
      Items.Strings = (
        #33099#19979
        #21475#20869
        #30452#32928)
    end
    object se3: TSpinEdit
      Left = 105
      Top = 36
      Width = 57
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 6
      Value = 1
    end
    object se4: TSpinEdit
      Left = 248
      Top = 31
      Width = 65
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 7
      Value = 1
    end
    object chk1: TCheckBox
      Left = 352
      Top = 42
      Width = 73
      Height = 17
      Caption = #29289#29702#38477#28201
      TabOrder = 8
    end
    object chk2: TCheckBox
      Left = 431
      Top = 42
      Width = 74
      Height = 17
      Caption = #22797#35797#20307#28201
      TabOrder = 9
    end
    object chk3: TCheckBox
      Left = 511
      Top = 42
      Width = 74
      Height = 17
      Caption = #20154#24037#20908#30496
      TabOrder = 10
    end
    object edt_3: TEdit
      Left = 79
      Top = 81
      Width = 153
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 11
    end
    object edt_4: TEdit
      Left = 330
      Top = 65
      Width = 169
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 12
      Text = '1149201102145498'
    end
    object edt_5: TEdit
      Left = 330
      Top = 92
      Width = 121
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 13
      Text = '1'
    end
    object btn3: TButton
      Left = 457
      Top = 92
      Width = 75
      Height = 25
      Caption = #22270#29255
      TabOrder = 14
      OnClick = btn3Click
    end
    object edt1: TEdit
      Left = 511
      Top = 65
      Width = 121
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 15
      Text = 'edt1'
    end
    object se5: TSpinEdit
      Left = 624
      Top = 3
      Width = 121
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 16
      Value = 8
    end
    object se1: TSpinEdit
      Left = 122
      Top = 3
      Width = 71
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 17
      Value = 750
    end
    object cbb2: TComboBox
      Left = 570
      Top = 92
      Width = 145
      Height = 21
      Style = csDropDownList
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      ItemHeight = 13
      ItemIndex = 1
      TabOrder = 18
      Text = 'none'
      OnChange = cbb2Change
      Items.Strings = (
        'client'
        'none')
    end
    object btn4: TButton
      Left = 638
      Top = 61
      Width = 75
      Height = 25
      Caption = 'btn4'
      TabOrder = 19
      OnClick = btn4Click
    end
    object edt_6: TEdit
      Left = 624
      Top = 34
      Width = 121
      Height = 21
      ImeName = #26497#21697#20116#31508#36755#20837#27861'6.9'#29256
      TabOrder = 20
      Text = '0001'
    end
    object btn5: TButton
      Left = 719
      Top = 61
      Width = 75
      Height = 25
      Caption = 'btn5'
      TabOrder = 21
      OnClick = btn5Click
    end
    object se6: TSpinEdit
      Left = 161
      Top = 102
      Width = 121
      Height = 22
      MaxValue = 0
      MinValue = 0
      TabOrder = 22
      Value = 0
    end
  end
  object qry_brxx: TADOQuery
    Connection = frm_main.con1
    LockType = ltReadOnly
    Parameters = <
      item
        Name = 'zyh'
        DataType = ftString
        NumericScale = 255
        Precision = 255
        Size = 16
        Value = Null
      end>
    SQL.Strings = (
      'declare @zyh varchar(16)'
      ''
      'set @zyh = :zyh'
      
        'select brxm, brnl,brxb,ryrq,b.bqmc,bch,tmh from zysf_zydj a,sys_' +
        'bqdm b'
      'where a.zyh =@zyh'
      ' and a.bqdm = b.bqdm'
      'union'
      
        'select brxm, brnl,brxb,ryrq,b.bqmc,bch,tmh from zysf_cydj a,sys_' +
        'bqdm b'
      'where a.zyh =@zyh'
      ' and a.bqdm = b.bqdm'
      '')
    Left = 80
    Top = 120
  end
  object qry_tw1: TADOQuery
    Connection = frm_main.con1
    LockType = ltReadOnly
    Parameters = <
      item
        Name = 'zyh'
        Size = -1
        Value = Null
      end
      item
        Name = 'ys'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      'declare @zyh varchar(16),@ksrq datetime,@ys int,@ksrq1 datetime'
      'set @zyh =:zyh'
      'set @ys =:ys'
      ''
      
        'if exists(select ryrq from zybl_cgjl where zyh = @zyh and ryrq i' +
        's not null)'
      'begin'
      
        '  select @ksrq = min(ryrq) from zybl_cgjl where zyh = @zyh and r' +
        'yrq is not null'
      'end else'
      'begin'
      '  if exists(select zyh from zysf_zydj where zyh = @zyh)'
      '    select @ksrq = ryrq from zysf_zydj where zyh = @zyh'
      '  else'
      '     select @ksrq = ryrq from zysf_cydj where zyh = @zyh'
      'end '
      '--select @ksrq1 = min(jlrq) from zybl_cgjl where zyh = @zyh'
      '--select @ksrq = min(jlrq) from zybl_rcjl where zyh =@zyh'
      '--if @ksrq1 <@ksrq'
      '--begin'
      '--set @ksrq = @ksrq1'
      '--end'
      'set @ksrq = @ksrq+7*(@ys-1)'
      
        'select xzqbq xzqb,mb,hx,xl,hxq,mb,tw,isnull(wljwhtw,0) wljwhtw,t' +
        'wfs,xh,datediff(day,convert(datetime,convert(char,@ksrq,112)),jl' +
        'rq)+1 ts,case  when isnull(wljwhtw,0)> 0 then 1 else 0 end wljw,'
      
        'fstw,case sm when '#39#20154#24037#20908#30496#39' then 1 else 0 end rgdm,case sm when '#39#20154#24037 +
        #20908#30496#39' then '#39#39' else sm end sm'
      'from zybl_rcjl '
      'where zyh =@zyh '
      'and convert(char,jlrq,112) >=convert(char,@ksrq,112)'
      'and datediff(day,@ksrq,jlrq) <=6'
      'order by jlrq,xh')
    Left = 80
    Top = 160
  end
  object qry_bt1: TADOQuery
    Connection = frm_main.con1
    LockType = ltReadOnly
    Parameters = <
      item
        Name = 'zyh'
        Size = -1
        Value = Null
      end
      item
        Name = 'ys'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      
        'declare @zyh varchar(16),@ksrq datetime,@ys int,@ryrq datetime,@' +
        'cybz int,@cyrq datetime,@jsrq datetime,@ksrq1 datetime'
      'set @zyh =:zyh'
      'if exists(select zyh from zysf_zydj where zyh =@zyh)'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq from zysf_zydj ' +
        'where zyh =@zyh '
      '   '
      'end else'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq  from zysf_cydj' +
        ' where zyh = @zyh'
      'end '
      ''
      
        'select @ryrq = ryrq from zybl_cgjl where zyh =@zyh  and convert(' +
        'char,jlrq,112) = convert(char,ryrq,112)'
      ''
      'set @ys =:ys'
      
        'if exists(select ryrq from zybl_cgjl where zyh = @zyh and ryrq i' +
        's not null)'
      'begin'
      
        '  select @ksrq = min(ryrq) from zybl_cgjl where zyh = @zyh and r' +
        'yrq is not null'
      'end else'
      'begin'
      '  if exists(select zyh from zysf_zydj where zyh = @zyh)'
      '  select @ksrq = ryrq from zysf_zydj where zyh = @zyh'
      '  else'
      '   select @ksrq = ryrq from zysf_cydj where zyh = @zyh'
      'end '
      'set @ksrq = @ksrq+7*(@ys-1)'
      'if @cybz = 1 '
      'begin'
      
        '  if datediff(day,convert(datetime,convert(char,@ksrq)),convert(' +
        'datetime,convert(char,@cyrq))) > 6 '
      '  begin'
      '    set @jsrq = @ksrq+6'
      '  end else'
      '  begin'
      '    set @jsrq = @cyrq'
      '  end'
      'end else'
      'begin'
      '  set @jsrq = @ksrq +6'
      'end'
      ''
      
        'if  datediff(day,convert(datetime,convert(char,@jsrq)),convert(d' +
        'atetime,convert(char,getdate()))) < 0'
      'begin'
      '  set @jsrq = getdate()'
      'end '
      ''
      'declare @i int'
      'set @i = 0'
      'create table #aa('
      'rq datetime'
      ')'
      ''
      
        'while @i < datediff(day,convert(datetime,convert(char,@ksrq)),co' +
        'nvert(datetime,convert(char,@jsrq)))+1 '
      'begin'
      '  insert into #aa(rq)'
      '  values(@ksrq+@i)'
      '  set @i = @i+1'
      'end'
      ''
      
        'select isnull(datediff(day,@ksrq,rq)+1,0) ts,datediff(day,conver' +
        't(datetime,convert(char(8),@ryrq,112)),#aa.rq)+1 zyts,#aa.rq jlr' +
        'q,'
      'substring(sd,1,2) sd,xh,'
      
        'case when convert(char(6),#aa.rq,112) <> convert(char(6),#aa.rq-' +
        '1,112) then 1'
      
        'else case when convert(char,#aa.rq,112) = convert(char,@ksrq,112' +
        ') then 1 else 0 end end yf '
      'from zybl_rcjl,#aa'
      'where zyh = @zyh'
      'and convert(char,jlrq,112) >=convert(char,@ksrq,112)'
      'and datediff(day,@ksrq,jlrq) <=6'
      'and convert(char,rq,112) *= convert(char,jlrq,112)'
      'order by jlrq'
      ''
      'drop table #aa'
      ''
      '')
    Left = 120
    Top = 160
  end
  object qry_cgjl1: TADOQuery
    Connection = frm_main.con1
    LockType = ltReadOnly
    Parameters = <
      item
        Name = 'zyh'
        Size = -1
        Value = Null
      end
      item
        Name = 'ys'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      
        'declare @zyh varchar(16),@ksrq datetime,@ys int,@ryrq datetime,@' +
        'ssrq datetime,@cybz int,@cyrq datetime,@jsrq datetime,@ksrq1 dat' +
        'etime'
      'set @zyh =:zyh'
      'if exists(select zyh from zysf_zydj where zyh =@zyh)'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq from zysf_zydj ' +
        'where zyh =@zyh '
      'end else'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq  from zysf_cydj' +
        ' where zyh = @zyh'
      'end '
      ''
      
        'select @ryrq = ryrq from zybl_cgjl where zyh = @zyh  and convert' +
        '(char,jlrq,112) = convert(char,ryrq,112)'
      ''
      'set @ys =:ys'
      ''
      
        'if exists(select ryrq from zybl_cgjl where zyh = @zyh and ryrq i' +
        's not null)'
      'begin'
      
        '  select @ksrq = min(ryrq) from zybl_cgjl where zyh = @zyh and r' +
        'yrq is not null'
      'end else'
      'begin'
      '  if exists(select zyh from zysf_zydj where zyh = @zyh)'
      '  select @ksrq = ryrq from zysf_zydj where zyh = @zyh'
      ' else'
      '   select @ksrq = ryrq from zysf_cydj where zyh = @zyh'
      'end '
      'set @ksrq = @ksrq+7*(@ys-1)'
      ''
      'if @cybz = 1 '
      'begin'
      
        '  if datediff(day,convert(datetime,convert(char,@ksrq)),convert(' +
        'datetime,convert(char,@cyrq))) > 6 '
      '  begin'
      '    set @jsrq = @ksrq+6'
      '  end else'
      '  begin'
      '    set @jsrq = @cyrq'
      '  end'
      'end else'
      'begin'
      '  set @jsrq = @ksrq +6'
      'end'
      ''
      
        'if  datediff(day,convert(datetime,convert(char,@jsrq)),convert(d' +
        'atetime,convert(char,getdate()))) < 0'
      'begin'
      '  set @jsrq = getdate()'
      'end '
      ''
      'declare @i int'
      'set @i = 0'
      'create table #bb('
      'rq datetime'
      ')'
      ''
      
        'while @i <= datediff(day,convert(datetime,convert(char,@ksrq)),c' +
        'onvert(datetime,convert(char,@jsrq))) '
      'begin'
      '  insert into #bb(rq)'
      '  values(@ksrq+@i)'
      '  set @i = @i+1'
      'end'
      ''
      ''
      
        'select identity(int,1,1) xh,@zyh zyh,rq jlrq,jllx,isnull(ryrq,ge' +
        'tdate()) ryrq,isnull(ssrq,getdate()+3000) ssrq,isnull(cyrq,getda' +
        'te()) cyrq,'
      'isnull(zrrq,getdate()) zrrq,isnull(fmrq,getdate()) fmrq,'
      'isnull(swrq,getdate()) swrq,'
      'datediff(day,@ksrq,rq)+1 ts,tz ssts,isnull(xbl,0) xbl,blng,'
      
        'isnull(dbcs,0) dbcs,isnull(syl,0) syl,isnull(yrl,0) yrl,xy,xy1,x' +
        'y2,tz,'
      
        'isnull(gc,0) gc,isnull(gchcs,0) gchcs,dbsj,rggm,xysj,xy1sj,xy2sj' +
        ',kg1,kg2,kg3,kg4,'
      'case when datediff(day,rq,@ryrq) = 0 then 1 else 0 end ry,'
      'case when datediff(day,jlrq,ssrq) = 0 then 1 else 0 end ss,'
      'case when datediff(day,jlrq,fmrq) = 0 then 1 else 0 end fm,'
      'case when datediff(day,jlrq,cyrq) = 0 then 1 else 0 end cy,'
      'case when datediff(day,jlrq,zrrq) = 0 then 1 else 0 end zr,'
      'case when datediff(day,jlrq,swrq) = 0 then 1 else 0 end sw'
      ' into #aa from zybl_cgjl,#bb'
      'where zyh = @zyh'
      'and convert(char,jlrq,112) >=convert(char,@ksrq,112)'
      'and datediff(day,@ksrq,jlrq) <=6'
      'and convert(char,rq,112) *=convert(char,jlrq,112)'
      'order by jlrq'
      'update #aa set ssts = '#39#39
      ''
      'select convert(datetime,convert(char,ssrq,112)) ssrq'
      'into #cc'
      'from zybl_cgjl'
      'where zyh =@zyh and ssrq is not null'
      'order by ssrq'
      ''
      'insert into #cc(ssrq)'
      'select convert(datetime,convert(char,fmrq,112)) ssrq'
      'from zybl_cgjl'
      'where zyh =@zyh and fmrq is not null'
      ''
      'select identity(int,1,1) xh,ssrq'
      'into #dd'
      'from #cc'
      'order by ssrq'
      ''
      ''
      
        'declare @jlhs int,@j int,@maxrq datetime,@minrq datetime,@jlrq d' +
        'atetime,@xh int'
      ''
      ''
      ''
      ''
      'set @j = 0'
      'select @jlhs = count(*) from #aa'
      'while @j < @jlhs'
      'begin'
      '  select @jlrq = jlrq from #aa where xh = @j+1'
      '  if exists(select max(ssrq) from #dd where '
      
        '  datediff(day,convert(datetime,convert(char,ssrq,112)),convert(' +
        'datetime,convert(char,@jlrq,112))) > 1'
      
        '  and datediff(day,convert(datetime,convert(char,ssrq,112)),conv' +
        'ert(datetime,convert(char,@jlrq,112))) < 15)'
      '  begin'
      '   select @xh = max(xh),@jlrq=max(ssrq) from #dd where '
      
        '   datediff(day,convert(datetime,convert(char,ssrq,112)),convert' +
        '(datetime,convert(char,@jlrq,112))) > 0'
      
        '   and datediff(day,convert(datetime,convert(char,ssrq,112)),con' +
        'vert(datetime,convert(char,@jlrq,112))) < 15'
      '   if @xh = 1 '
      '   begin'
      
        '     update #aa set ssts = convert(varchar,datediff(day,convert(' +
        'datetime,convert(char,@jlrq,112)),convert(datetime,convert(char,' +
        'jlrq,112))))'
      '     where xh = @j+1'
      '   end else'
      '   begin'
      
        '     update #aa set ssts = convert(varchar,datediff(day,convert(' +
        'datetime,convert(char,@jlrq,112)),convert(datetime,convert(char,' +
        'jlrq,112))))+'#39'/'#39'+convert(varchar,@xh)'
      '     where xh = @j+1'
      '   end'
      ' end'
      ' set @j = @j+1  '
      'end '
      ''
      ''
      ''
      
        'if exists(select ryrq from zybl_cgjl where zyh =@zyh and ryrq is' +
        ' not null)'
      'begin'
      
        ' update #aa set ryrq = a.ryrq from (select min(ryrq) ryrq,zyh fr' +
        'om zybl_cgjl where zyh =@zyh and ryrq is not null group by zyh) ' +
        'a'
      'where #aa.zyh = a.zyh'
      'end else'
      'begin'
      
        ' update #aa set ryrq = a.ryrq from zysf_zydj a where #aa.zyh = a' +
        '.zyh'
      'end '
      'update #aa set ryrq = @ryrq'
      'select * from #aa order by xh'
      ''
      'drop table #aa'
      'drop table #bb'
      'drop table #cc'
      'drop table #dd')
    Left = 160
    Top = 160
  end
  object qry_kscw1: TADOQuery
    Connection = frm_main.con1
    LockType = ltBatchOptimistic
    Parameters = <
      item
        Name = 'zyh'
        Size = -1
        Value = Null
      end
      item
        Name = 'ys'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      
        'declare @zyh varchar(16),@ksrq datetime,@ys int,@ryrq datetime,@' +
        'cybz int,@cyrq datetime,@jsrq datetime,@ksrq1 datetime'
      'set @zyh =:zyh'
      'if exists(select zyh from zysf_zydj where zyh =@zyh)'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq from zysf_zydj ' +
        'where zyh =@zyh '
      '   select @ksrq = ryrq from zysf_zydj where zyh = @zyh'
      'end else'
      'begin'
      
        '   select @cybz =cybz, @ryrq = ryrq,@cyrq = cyrq  from zysf_cydj' +
        ' where zyh = @zyh'
      '   select @ksrq = ryrq from zysf_cydj where zyh = @zyh'
      'end '
      ''
      
        'select @ryrq = ryrq from zybl_cgjl where zyh = @zyh  and convert' +
        '(char,jlrq,112) = convert(char,ryrq,112)'
      ''
      'set @ys =:ys'
      
        'if exists(select ryrq from zybl_cgjl where zyh = @zyh and ryrq i' +
        's not null)'
      'begin'
      
        '  select @ksrq = min(ryrq) from zybl_cgjl where zyh = @zyh and r' +
        'yrq is not null'
      'end '
      'set @ksrq = @ksrq+7*(@ys-1)'
      'if @cybz = 1 '
      'begin'
      
        '  if datediff(day,convert(datetime,convert(char,@ksrq)),convert(' +
        'datetime,convert(char,@cyrq))) > 6 '
      '  begin'
      '    set @jsrq = @ksrq+6'
      '  end else'
      '  begin'
      '    set @jsrq = @cyrq'
      '  end'
      'end else'
      'begin'
      '  set @jsrq = @ksrq +6'
      'end'
      ''
      
        'if  datediff(day,convert(datetime,convert(char,@jsrq)),convert(d' +
        'atetime,convert(char,getdate()))) < 0'
      'begin'
      '  set @jsrq = getdate()'
      'end '
      ''
      'select ksdm,bch,jlrq into #aa from zybl_rcjl '
      'where zyh =@zyh '
      'and convert(char,jlrq,112) >= convert(char,@ksrq,112) '
      'and convert(char,jlrq,112) <= convert(char,@jsrq,112) '
      ''
      'insert into #aa'
      'select ksdm,bch,jlrq from zybl_cgjl '
      'where zyh =@zyh '
      'and convert(char,jlrq,112) >= convert(char,@ksrq,112) '
      'and convert(char,jlrq,112) <= convert(char,@jsrq,112) '
      ''
      'select distinct b.mc ks,a.bch,a.jlrq into #bb '
      'from #aa a,sys_ksdm b'
      'where a.ksdm = b.dm'
      'order by jlrq'
      ''
      'select distinct ks,bch from #bb')
    Left = 200
    Top = 160
  end
  object sp_cgjl: TADOStoredProc
    Connection = frm_main.con1
    LockType = ltReadOnly
    ProcedureName = 'zybl_se_cgjl'
    Parameters = <
      item
        Name = '@RETURN_VALUE'
        DataType = ftInteger
        Direction = pdReturnValue
        Precision = 10
        Value = Null
      end
      item
        Name = '@zyh'
        Attributes = [paNullable]
        DataType = ftString
        Size = 16
        Value = Null
      end
      item
        Name = '@ys'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end>
    Left = 160
    Top = 192
  end
  object sp_tw: TADOStoredProc
    Connection = frm_main.con1
    LockType = ltReadOnly
    ProcedureName = 'zybl_se_tw'
    Parameters = <
      item
        Name = '@RETURN_VALUE'
        DataType = ftInteger
        Direction = pdReturnValue
        Precision = 10
        Value = Null
      end
      item
        Name = '@zyh'
        Attributes = [paNullable]
        DataType = ftString
        Size = 16
        Value = Null
      end
      item
        Name = '@ys'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end>
    Left = 80
    Top = 192
  end
  object sp_bt: TADOStoredProc
    Connection = frm_main.con1
    LockType = ltReadOnly
    ProcedureName = 'zybl_se_twbbt'
    Parameters = <
      item
        Name = '@RETURN_VALUE'
        DataType = ftInteger
        Direction = pdReturnValue
        Precision = 10
        Value = Null
      end
      item
        Name = '@zyh'
        Attributes = [paNullable]
        DataType = ftString
        Size = 16
        Value = Null
      end
      item
        Name = '@ys'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end>
    Left = 120
    Top = 192
  end
  object sp_kscw: TADOStoredProc
    Connection = frm_main.con1
    LockType = ltReadOnly
    ProcedureName = 'zybl_se_kscw'
    Parameters = <
      item
        Name = '@RETURN_VALUE'
        DataType = ftInteger
        Direction = pdReturnValue
        Precision = 10
        Value = Null
      end
      item
        Name = '@zyh'
        Attributes = [paNullable]
        DataType = ftString
        Size = 16
        Value = Null
      end
      item
        Name = '@ys'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end>
    Left = 200
    Top = 192
  end
end
